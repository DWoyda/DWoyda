name: Countdown Update

on:
  schedule:
    - cron: "0 * * * *" # every hour
  workflow_dispatch:

jobs:
  update-countdown:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Set target date (7 days from the next Sunday)
        id: setup
        run: |
          TARGET_DATE=$(date -d "next sunday +7 days" -u +"%Y-%m-%dT00:00:00Z")
          echo "TARGET_DATE=$TARGET_DATE" >> $GITHUB_ENV

      - name: Calculate remaining time
        run: |
          NOW=$(date -u +"%Y-%m-%dT%H:%M:%SZ")
          SECS_LEFT=$(( $(date -d "$TARGET_DATE" +%s) - $(date -d "$NOW" +%s) ))

          if [ $SECS_LEFT -lt 0 ]; then
            TEXT="Countdown finished"
          else
            DAYS=$((SECS_LEFT / 86400))
            HOURS=$(( (SECS_LEFT % 86400) / 3600 ))
            MINUTES=$(( (SECS_LEFT % 3600) / 60 ))
            TEXT="Time remaining: ${DAYS} days, ${HOURS} hours, ${MINUTES} minutes"
          fi

          sed -i "/<!-- TIMER_START -->/,/<!-- TIMER_END -->/c\<!-- TIMER_START -->\n${TEXT}\n<!-- TIM_
